<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
</head>
<body>
<main class="container">
    <section id="search-form">
        <h1 class="mt-5">Pet Search</h1>
        {{ form_start(form, {'attr': {'method': 'get'}}) }}

        <div class="mb-3">
            {{ form_label(form.name, 'Enter filter by Name:', {'label_attr': {'class': 'form-label'}}) }}
            {{ form_widget(form.name, {'attr': {'class': 'form-control'}, 'value': petSearchDto.name ?? null}) }}
        </div>

        <div class="mb-3">
            {{ form_label(form.description, 'Enter filter by Description:', {'label_attr': {'class': 'form-label'}}) }}
            {{ form_widget(form.description, {'attr': {'class': 'form-control'}, 'value': petSearchDto.description ?? null}) }}
        </div>

        <div class="mb-3">
            {{ form_label(form.owner, 'Enter filter by Owner:', {'label_attr': {'class': 'form-label'}}) }}
            {{ form_widget(form.owner, {'attr': {'class': 'form-control'}, 'value': petSearchDto.owner ?? null}) }}
        </div>

        <button type="submit" class="btn btn-primary">Search</button>

        {{ form_end(form) }}
    </section>

    <hr>
    <section id="search-results">
        <h2 class="mt-5">Search Results</h2>

        <table class="table">
            <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Description</th>
                <th>Owner</th>
            </tr>
            </thead>
            <tbody>
            {% for pet in paginator %}
                <tr>
                    <td>{{ pet.id }}</td>
                    <td>{{ pet.name }}</td>
                    <td>{{ pet.description }}</td>
                    <td>{{ pet.owner.name }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

        {% if paginator is not null and paginator.count() > 0 %}
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center mt-3">
                    {% set currentPage = paginator.query.getFirstResult() / paginator.query.getMaxResults() + 1 %}
                    {% set pageCount = (paginator.count() / paginator.query.getMaxResults())|round(0, 'ceil') %}

                    {% if currentPage > 1 %}
                        <li class="page-item">
                            <a class="page-link" href="{{ path('app_pet_search', {'page': 1}|merge(app.request.query.all)) }}">First</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="{{ path('app_pet_search', {'page': currentPage - 1}|merge(app.request.query.all)) }}">Previous</a>
                        </li>
                    {% endif %}

                    {% for page in 1..pageCount %}
                        <li class="page-item{% if page == currentPage %} active{% endif %}">
                            <a class="page-link" href="{{ path('app_pet_search', {'page': page, 'name': form.vars.value.name ?? null, 'description': form.vars.value.description ?? null, 'owner': form.vars.value.owner ?? null }) }}">{{ page }}</a>
                        </li>
                    {% endfor %}

                    {% if currentPage < pageCount %}
                        <li class="page-item">
                            <a class="page-link" href="{{ path('app_pet_search', {'page': currentPage + 1}|merge(app.request.query.all)) }}">Next</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="{{ path('app_pet_search', {'page': pageCount}|merge(app.request.query.all)) }}">Last</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        {% endif %}
    </section>
</main>
</body>
</html>